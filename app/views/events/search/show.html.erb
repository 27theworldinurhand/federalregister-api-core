<% title @search.term.blank? ? 'Event Search' : "Event Search Results for '#{h @search.term}'" %>
<% feed_autodiscovery url_for(params.merge(:format => :rss, :order => 'date', :publication_date_less_than => nil)) %>

<h1 class="title"><span>Search Events</span></h1>

<% unless @search.valid? %>
<ul class="errors">
  <% @search.errors.each do |err| %>
  <li><%= err %></li>
  <% end %>
</ul>
<% end %>

<%= render :esi => url_for(params.merge(:action => :header)) %>

<% unless @search.blank? %>

  <div class="filters">
    <%= render :esi => url_for(params.merge(:action => :facets, :facet => 'type')) %>
    <%= render :esi => url_for(params.merge(:action => :facets, :facet => 'agency')) %>
    
    <%= render :partial => 'search/location_form', :locals => {:search => @search } %>

  </div>
  
  <%= render :esi => url_for(params.merge(:action => :results)) %>
<% end %>