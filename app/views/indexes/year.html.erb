<% title "#{@year} FR Index" %>

<div class="title"><span><%= @year %> FR Index</span></div>

<div id="fr-index-metadata" class="page_summary">
  <h1><%= @year %> Federal Register Index</h1>

  <hr />

  <p>
    This index provides descriptive entries and Federal Register page numbers
    for documents published in the daily Federal Register. It includes entries, 
    with select metadata for all documents published in the <%= @year %> calendar year.
  </p>

  <p>
    Each agency below is followed by a count that represents the number of articles for 
    that agency in the <%= @year %> FR Index. The count is omitted for agency publishing 
    less than 2 articles in a given year.
  </p>

  <p id="agency-jump-nav">
    Jump to Agencies: <%= @agencies_grouped_by_first_letter.map{|l,g| "<a href='##{l}' class='letter_link'>#{l}</a>"}.join(' | ') %>
  <p>

</div>

<div class="index_agencies">
  <% @agencies_grouped_by_first_letter.each do |letter, agencies| %>
    <h3 id="<%= letter %>">
      <%= letter %>
      <a href="#fr-index-metadata">back to top</a>
    </h3>
    <ul>
    <% agencies.each do |agency| %>
      <li>
        <%= link_to agency.name, index_year_agency_path(@year, agency) %>
        <%= content_tag(:span, agency.entries_count, :class => "count_pill") if agency.entries_count > 1 %>
        <% if agency.children.present? %>
        <ul>
          <% agency.children.each do |sub_agency| %>
            <li>
              <span class="see">See</span> 
              <%= link_to sub_agency.name, index_year_agency_path(@year, sub_agency) %>
              <%= content_tag(:span, sub_agency.entries_count, :class => "count_pill") if sub_agency.entries_count > 1 %>
            </li>
          <% end %>
        </ul>
        <% end %>
      </li>
    <% end %>
    </ul>
  <% end %>
</div>
