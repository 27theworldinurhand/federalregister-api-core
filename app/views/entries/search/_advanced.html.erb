<%= render :partial => "search/date_form", :locals => {:f => f, :attribute => :publication_date, :label => "Publication Date "} %>
<%= render :partial => "search/date_form", :locals => {:f => f, :attribute => :effective_date, :label => "Effective Date "} %>

<% f.inputs :class => 'show_labels' do %>
  <% if js_known_to_be_enabled? %>
    <%# put hidden fields and stub for JS-variation here %>
    
    <li class="string optional agency">
      <label>Agency</label>
      <input placeholder="Department of Agriculture" data-autocomplete="autocomplete" />

      <%= f.input :agency_ids,
                  :as => :select,
                  :label => "Agencies",
                  :include_blank => false,
                  :input_html => {:multiple => true},
                  :value_method => Proc.new{|a| a.id.to_s},
                  :collection => Agency.all(:conditions => {:id => @search.agency_ids.to_a} ),
                  :wrapper_html => {:class => 'selected_agency_list'} %>
    </li>  
    
  <% else %>
    <%= f.input :agency_ids,
                :as => :select,
                :label => "Agencies",
                :include_blank => false,
                :input_html => {:multiple => true},
                :value_method => Proc.new{|a| a.id.to_s},
                :collection => Agency.all %>
  <% end %>
  <%= f.input :type,
              :label => "Document Category",
              :as => :check_boxes,
              :collection => EntrySearch::TYPES %>
  <%= f.input :docket_id,
              :label => "Agency Docket",
              :input_html => {:placeholder => "EPA-HQ-OPPT-2005-0049"}, 
              :wrapper_html => {:class => 'docket'} %>
  <%= f.input :regulation_id_number,
              :label => "Regulation ID Number",
              :input_html => {:placeholder => "2070-AJ57"},
              :hint => @search.regulatory_plan_title,
              :wrapper_html => {:class => 'reg_id'} %>
  <%= f.input :significant,
              :as => :boolean,
              :label => "Deemed Significant by OIRA",
              :unchecked_value => '',
              :wrapper_html => {:class => 'significant'} %>
<% end %>

<% f.fields_for :cfr, f.object.cfr do |cfr_f| %>
  <% cfr_f.inputs :name => "Affecting CFR Part", :class => 'cfr' do %>
    <%= cfr_f.input :title,
                    :input_html => {:placeholder => '40'} %>
    <%= cfr_f.input :part,
                    :input_html => {:placeholder => '745'} %>
  <% end %>
<% end %>
  
<% f.inputs :name => "Mentioning Locations Near", :class => 'zip' do %>
  <%= f.input :location,
              :input_html => {:placeholder =>  "Zip Code"} %>
  <%= f.input :within,
              :as => :select,
              :collection => [5, 10, 25, 50, 100, 200].map{|n| ["#{n} miles", n]} %>
<% end %>

<% [:topic_ids, :section_ids].each do |param| %>
  <% (params[:conditions] || {})[param].to_a.each do |val| %>
    <%= hidden_field_tag "conditions[#{param}][]", val %>
  <% end %>
<% end %>

<% f.buttons do %>
  <%= f.commit_button 'Search' %>
  <li>
    <%= link_to "Clear Form", entries_search_path, :class => "clear_form" %>
  </li>
<% end %>